on: [push]
env:
  OUT_DIR: output
  IN_DIR: markdown
  STYLES_DIR: styles
  STYLE: chmduquesne
jobs:
     publish_resume:
      runs-on: ubuntu-latest
      name: Build and publish resume in html pdf docx and rtf
      steps:
        - uses: actions/checkout@v2
        - uses: docker://tdhopper/pandoc-context:latest
          with:
            args: >- # allows you to break string into multiple lines
              --standalone --include-in-header styles/chmduquesne.css
              --lua-filter=pdc-links-target-blank.lua
              --from markdown --to html
              --output output/index.html
              --metadata pagetitle="Tim Hopper â€” Machine Learning Engineer"
              markdown  /resume.md
        - uses: docker://tdhopper/pandoc-context:latest
          with:
            args: >-
              --standalone --template styles/chmduquesne.tex
              --from markdown --to context
              --variable papersize=A4
              --output output/resume.tex
        - name: Publish to netlify
          uses: netlify/actions/cli@master
          with:
            args: deploy --dir=./output --timeout 30 --prod
          env:
            NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID }}
            NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN }}
